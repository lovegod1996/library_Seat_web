<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xoqao.web.dao.UserMapper" >
<!--根据手机号或学号查找用户-->
  <select id="findUserByphoneOrSno" resultType="com.xoqao.web.bean.user.User">
  SELECT  uid,nick,sno,password,college,classes,phone,name,major  FROM  user where  phone LIKE  '${loginstr}'  OR  sno LIKE '${loginstr}'
</select>

<!--查找所有学生-->
  <select id="findAllUsers" resultType="com.xoqao.web.bean.user.User">
     SELECT  uid,nick,sno,password,college,classes,phone,name,major
     FROM  user
     WHERE sno LIKE '${year}%' AND college LIKE '${college}%' AND  major LIKE  '${major}%'
  </select>
  <select id="findAllUsersPage" resultType="com.xoqao.web.bean.user.User">
    SELECT  uid,nick,sno,password,college,classes,phone,name,major
     FROM  user
     WHERE sno LIKE '${year}%' AND college LIKE '${college}%' AND  major LIKE  '${major}%'
      limit #{startRow},#{pageSize}
  </select>

  <!--删除某个学生-->
  <delete id="deleteUserByID" >
    DELETE  FROM  user WHERE uid =#{uid}
  </delete>
<!--添加一个学生-->
  <insert id="insertUser">
    <selectKey resultType="java.lang.Integer" keyProperty="uid" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    INSERT INTO  user ( nick,sno,password,college,classes,phone,name,major ) VALUES (#{user.nick},#{user.sno},#{user.password},#{user.college},#{user.classes},#{user.phone},#{user.name},#{user.major})
  </insert>


  <!--查询所有的学院-->
  <select id="findAllCollege" resultType="java.lang.String">
    SELECT college from user GROUP BY  college
  </select>
  <!--根据学院查询专业-->
  <select id="findMajorByCollege" resultType="java.lang.String">
    SELECT DISTINCT major FROM user WHERE college LIKE '${college}' GROUP BY major
  </select>
</mapper>